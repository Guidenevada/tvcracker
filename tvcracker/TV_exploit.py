import os
import sys
import time
import random
import requests
import json
import re
import urllib3
import socket

def get_my_exernal_ip():
    url = 'http://httpbin.org/ip'
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.text
        else:
            return None
    except requests.RequestException:
        return None

def get_local_ip():
    hostname = socket.gethostname()
    local_ip = socket.gethostbyname(hostname)
    print(local_ip)

def exploittv(ip, url):
    if requests.get(url):
        os.system("python3 __init__/gobuster dir ", url, " -x xml,txt,html,php -w __init__/wordlist.txt | grep 'Status 200' ")
    else: 
        print("Unknow error in wordlist")

def send_request(url, data):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362'
    }
    try:
        response = requests.post(url, data=data, headers=headers)
        if response.status_code == 200:
            return response.text
        else:
            return None
    except requests.RequestException:
        return None

    
def get_page(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.text
        else:
            return None
    except requests.RequestException:
        return None

def get_url(ip):
    url = 'http://' + ip + ':8080'
    response = get_page(url)
    if response:
        return True
    else:
        return False

def scan_net(ip_list):
    for ip in ip_list:
        if get_url(ip):
            print(ip, "is possibly the TV")
            exploittv(ip)
        else:
            print(ip, "is not the TV")


def get_ip_list():
    ip_list = []
    for i in range(1, 256):
        ip = '192.168.1.' + str(i)
        ip_list.append(ip)
    return ip_list

def main():
    ip_list = get_ip_list()
    scan_net(ip_list)

if __name__ == '__main__':
    main()